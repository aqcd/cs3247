using System.Collections;
using System.Collections.Generic;
using UnityEngine;
using Mirror;

public class Invulnerability : MonoBehaviour, ISkill
{
    private GameObject player;
    private GameObject spherePrefab;
    private Health playerHealth;
    private float invulDuration = SkillConstants.INVUL_DURATION;
    private AudioManager audioManager;

    void Awake()
    {
        player = MatchManager.instance.GetPlayer();
        playerHealth = player.GetComponent<Health>();
        audioManager = player.GetComponent<AudioManager>();

        spherePrefab = transform.GetComponent<ProjectileManager>().projectilePrefabs[0];
    }

    public void Execute(Vector3 skillPosition) 
    {
        // Set the boolean to play casting animation to true.
        // player.GetComponent<Animator>().SetBool("isHeal", true);

        playerHealth.BecomeInvulnerable(invulDuration);
        SpawnSphere(player.transform.position);

        // audioManager.PlaySound(AudioIndex.INCREASE_HEALTH_AUDIO, skillPosition);
    }

    public void SpawnSphere(Vector3 pos)
    {
        GameObject sphere = GameObject.Instantiate(spherePrefab, pos, Quaternion.identity);
        sphere.transform.SetParent(player.transform);
        NetworkServer.Spawn(sphere);
    }
}
